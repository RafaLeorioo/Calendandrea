<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calendario de Horarios de Trabajo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f7fc;
      color: #333;
      padding: 5vh 5vw;
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      overflow-y: auto;
    }

    h2 {
      color: #2c3e50;
      margin-bottom: 2vh;
      font-size: 4vw;
    }

    h3 {
      color: #34495e;
      margin-top: 2vh;
      font-size: 3.5vw;
    }

    .container {
      width: 90vw;
      max-width: 800px;
      margin: auto;
      background-color: #fff;
      padding: 5vh 4vw;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .agregar-turno {
      position: sticky;
      top: 5vh;
      background-color: #fff;
      padding: 4vh 4vw;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 10;
      border-radius: 8px;
    }

    .flex-row {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      margin-bottom: 3vh;
    }

    input[type="date"],
    input[type="time"],
    textarea {
      padding: 3vh 3vw;
      font-size: 4vw;
      border: 2px solid #ccc;
      border-radius: 5px;
      margin-bottom: 3vh;
      width: 100%;
      box-sizing: border-box;
    }

    textarea {
      height: 10vh;
      resize: none;
    }

    button {
      padding: 3vh 4vw;
      font-size: 4vw;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      width: 100%;
      box-sizing: border-box;
    }

    button:hover {
      background-color: #2980b9;
    }

    .dia {
      margin-top: 5vh;
      padding-bottom: 2vh;
      border-bottom: 2px solid #3498db;
    }

    .dia h4 {
      color: #2980b9;
      font-size: 5vw;
      margin-bottom: 2vh;
    }

    .turno {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      padding: 4vh 4vw;
      margin-bottom: 3vh;
      background-color: #ecf0f1;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }

    .turno p {
      font-size: 4vw;
      color: #7f8c8d;
    }

    .eliminar-btn {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 3vh 4vw;
      border-radius: 50px;
      cursor: pointer;
      font-size: 3vw;
      transition: background-color 0.3s ease;
      margin-top: 2vh;
    }

    .eliminar-btn:hover {
      background-color: #c0392b;
    }

    #listaTurnos {
      max-height: 45vh;
      overflow-y: auto;
      padding-right: 2vw;
    }

    @media (max-width: 768px) {
      .container {
        padding: 5vh 4vw;
      }

      .agregar-turno {
        padding: 3vh 4vw;
      }

      .dia h4 {
        font-size: 5vw;
      }

      button {
        font-size: 5vw;
      }

      .eliminar-btn {
        padding: 2vh 4vw;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 5vh 3vw;
      }

      h2 {
        font-size: 5vw;
      }

      h3 {
        font-size: 4vw;
      }

      .dia h4 {
        font-size: 6vw;
      }

      .turno p {
        font-size: 5vw;
      }

      .eliminar-btn {
        font-size: 5vw;
        padding: 2vh 3vw;
      }
    }
  </style>
</head>
<body>
  <h2>Calendario de Horarios de Trabajo</h2>
  <div class="container">
    <div class="agregar-turno">
      <h3>Agregar Turno</h3>
      <div class="flex-row">
        <input type="date" id="fecha" />
        <input type="time" id="horaInicio" />
        <input type="time" id="horaFin" />
      </div>
      <textarea
        id="observaciones"
        placeholder="Agregar observaciones (opcional)"
      ></textarea>
      <br />
      <button onclick="agregarTurno()">Guardar Turno</button>
    </div>

    <h3>Turnos Registrados</h3>
    <div id="listaTurnos"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", mostrarTurnos);

    function agregarTurno() {
      let fecha = document.getElementById("fecha").value;
      let horaInicio = document.getElementById("horaInicio").value;
      let horaFin = document.getElementById("horaFin").value;
      let observaciones = document.getElementById("observaciones").value;

      if (!fecha || !horaInicio || !horaFin) {
        alert("Por favor, completa todos los campos.");
        return;
      }

      if (horaFin <= horaInicio) {
        alert("La hora de fin debe ser mayor que la hora de inicio.");
        return;
      }

      let turnos = JSON.parse(localStorage.getItem("turnos")) || [];
      // Agrupar por día
      let turnosPorDia = {};

      turnos.push({ fecha, horaInicio, horaFin, observaciones });

      // Agrupar los turnos por fecha
      turnos.forEach((turno) => {
        if (!turnosPorDia[turno.fecha]) {
          turnosPorDia[turno.fecha] = [];
        }
        turnosPorDia[turno.fecha].push(turno);
      });

      // Ordenar las fechas
      let fechasOrdenadas = Object.keys(turnosPorDia).sort((a, b) => new Date(a) - new Date(b));

      // Reorganizar los turnos en el orden de fechas y por hora dentro de cada día
      let turnosOrdenados = [];
      fechasOrdenadas.forEach((fecha) => {
        turnosPorDia[fecha].sort((a, b) => a.horaInicio.localeCompare(b.horaInicio)); // Ordenar por hora de inicio
        turnosOrdenados = [...turnosOrdenados, ...turnosPorDia[fecha]];
      });

      localStorage.setItem("turnos", JSON.stringify(turnosOrdenados));
      mostrarTurnos();
    }

    function mostrarTurnos() {
      let lista = document.getElementById("listaTurnos");
      lista.innerHTML = "";
      let turnos = JSON.parse(localStorage.getItem("turnos")) || [];
      let turnosPorDia = {};

      // Agrupar los turnos por fecha
      turnos.forEach((turno) => {
        if (!turnosPorDia[turno.fecha]) {
          turnosPorDia[turno.fecha] = [];
        }
        turnosPorDia[turno.fecha].push(turno);
      });

      // Mostrar los turnos agrupados por día
      for (let fecha in turnosPorDia) {
        let divDia = document.createElement("div");
        divDia.className = "dia";

        let fechaFormateada = new Date(fecha);
        let opciones = { year: "numeric", month: "long", day: "numeric" };
        let fechaTexto = fechaFormateada.toLocaleDateString("es-ES", opciones);

        let titulo = document.createElement("h4");
        titulo.textContent = fechaTexto;
        divDia.appendChild(titulo);

        turnosPorDia[fecha].forEach((turno, index) => {
          let divTurno = document.createElement("div");
          divTurno.className = "turno";
          divTurno.innerHTML = `
            <strong>${turno.horaInicio} a ${turno.horaFin}</strong>
            <p>${turno.observaciones || "Sin observaciones"}</p>
            <button class="eliminar-btn" onclick="eliminarTurno(${index})">Eliminar</button>
          `;
          divDia.appendChild(divTurno);
        });

        lista.appendChild(divDia);
      }
    }

    function eliminarTurno(index) {
      let turnos = JSON.parse(localStorage.getItem("turnos")) || [];
      turnos.splice(index, 1);
      localStorage.setItem("turnos", JSON.stringify(turnos));
      mostrarTurnos();
    }
  </script>
</body>
</html>
